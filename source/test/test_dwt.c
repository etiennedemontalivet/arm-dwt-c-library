/* ----------------------------------------------------------------------
 * Project:      DSP Library
 * Title:        test_dwt.c
 * Description:  DWT Floating point test function
 *
 * $Date:        05. July 2020
 * $Revision:    V.0.0.1
 *
 * Target Processor: Cortex-M7/Cortex-M4/Cortex-M3/Cortex-M0
 * -------------------------------------------------------------------- */

#include "test_dwt.h"
#include "arm_dwt_f32.h"

/* From Python - PyWavelets */
/* -----------------------------
 * To generate the filters (kernels, wavelets) using python:
 * import pywt
 * pywt.Wavelet('db2').dec_hi
 * pywt.Wavelet('db2').dec_low
 * @see: https://pywavelets.readthedocs.io/en/latest/ref/wavelets.html
 * ----------------------------- */
/* Daubechies 2 */
static  float32_t daub2HighFilter[ 4 ] =
{
		-0.48296291,  0.8365163 , -0.22414387, -0.12940952
};
static  float32_t daub2LowFilter[ 4 ] =
{
		-0.12940952,  0.22414387,  0.8365163 ,  0.48296291
};

/* Random input signal */
static float32_t signal[ 1000 ] =
{
		7.8683813771e-01, 2.8184374520e-02, 3.0086017341e-01, 4.5511745775e-01, 6.5607588559e-02, 2.8646730641e-01, 1.7291555492e-01, 7.2874478029e-01, 6.1354147958e-02, 1.8723310729e-02, 6.1282002033e-01, 4.9576355155e-01, 2.9441838349e-01, 5.3255894424e-01, 3.3019886745e-01, 2.8717027470e-01, 1.5272674820e-01, 1.9921584231e-01, 7.0865212016e-01, 2.3537785518e-01, 7.4624823085e-01, 5.1414948072e-01, 8.5026217370e-01, 7.6441875846e-01, 7.9840857460e-02, 4.9574655597e-01, 5.4680698279e-01, 8.5089213295e-02, 9.5355713433e-01, 2.3020323722e-01, 3.6751363902e-01, 6.5748932598e-01, 4.7889589855e-01, 9.4303957487e-01, 5.0125175506e-01, 1.1805840708e-01, 6.7296123579e-01, 3.6406250907e-01, 1.9457516253e-01, 1.6258006557e-01, 1.8403476488e-01, 9.2296869802e-01, 6.8129115152e-01, 5.4831981923e-01, 7.7197074431e-01, 5.8834143184e-01, 6.7541751420e-01, 5.5321177761e-01, 1.8234531768e-01, 8.8508995218e-01, 2.5995025965e-01, 9.2151885788e-01, 3.9464626861e-01, 1.8503666386e-01, 2.9052301839e-01, 8.1101240238e-01, 9.3775505143e-01, 1.1827512963e-01, 8.9103152830e-01, 9.2505892896e-02, 7.0502324565e-01, 2.0948513366e-01, 2.9924503378e-01, 1.4481107157e-01, 5.5699447241e-01, 1.5680284026e-01, 9.8156646737e-02, 9.4851633950e-01, 6.5393991939e-02, 9.0258158484e-02, 9.7116255628e-01, 3.2898755402e-02, 4.0781981263e-01, 1.1688646608e-02, 6.3317648419e-01, 9.4060629552e-01, 7.7007600958e-01, 5.9433908856e-02, 4.1909000123e-01, 3.4556480127e-02, 9.5414699238e-01, 3.0273454903e-01, 6.6556357768e-01, 5.2979719622e-01, 9.1780610182e-01, 9.6936210256e-02, 2.8499325454e-01, 4.7302940414e-01, 7.6979451403e-01, 1.1011005815e-01, 7.0869802584e-01, 1.7257478922e-01, 3.8260878830e-01, 2.7242068731e-01, 7.2827689950e-01, 3.0076858148e-01, 3.7580978721e-01, 7.0875077097e-01, 8.3282378652e-01, 7.5329373961e-01, 1.4879581058e-01, 1.4989377544e-01, 9.8169544176e-01, 6.7269957774e-01, 1.5476120688e-01, 7.8597557128e-01, 8.6677556800e-01, 3.7206406260e-01, 3.4273237725e-01, 6.7927984757e-02, 1.2452872028e-01, 3.9825074031e-01, 1.8406845372e-01, 1.0973965852e-01, 8.5302619250e-01, 8.4470966383e-01, 5.6862269324e-01, 2.0082517207e-01, 6.7522239581e-01, 1.4154430923e-02, 8.3471555093e-01, 9.6057254166e-01, 7.9471397813e-01, 5.2032099045e-01, 6.3686213114e-01, 3.7679897168e-01, 5.8158570430e-01, 7.8045378699e-01, 8.5097216019e-01, 4.9037457377e-01, 7.8356482163e-01, 5.7176711112e-01, 8.8268982476e-01, 6.7531436180e-01, 1.1812755433e-01, 6.0890621154e-01, 3.1521073607e-03, 2.6097129451e-01, 3.3963544003e-01, 4.1495908436e-01, 7.5742183237e-03, 6.4840714252e-01, 7.9539731004e-01, 9.3608713569e-01, 1.3774476865e-01, 4.6613194231e-01, 9.2311958030e-01, 2.6332043227e-01, 3.2948467230e-01, 2.7475274458e-01, 6.3230437937e-02, 5.5033408257e-02, 7.6254761851e-01, 5.6956148899e-01, 8.4617649890e-02, 7.1855110763e-01, 9.7135032160e-01, 6.1767054009e-01, 5.1018569008e-01, 2.1301461301e-01, 3.4139046729e-01, 4.3251688627e-01, 8.3096684679e-01, 7.2392956394e-01, 3.0215239835e-01, 5.3772939688e-01, 3.8516999289e-01, 7.7580857741e-01, 5.1031637095e-01, 3.1532369351e-01, 1.9580786177e-01, 7.9878485100e-01, 3.5737047187e-01, 2.5640395809e-01, 2.9783326716e-01, 1.4538010104e-01, 1.6601821304e-01, 5.1374975015e-01, 9.2971462204e-01, 5.3409689129e-01, 8.7170541242e-01, 2.1065184304e-01, 1.4073461031e-01, 8.9491608205e-01, 4.1521407523e-01, 1.3362431255e-01, 7.8193282166e-01, 8.8657155620e-02, 2.5053353858e-01, 9.7282126633e-01, 2.3835910006e-01, 6.1186002391e-01, 8.3835199014e-01, 3.0215050531e-01, 8.9492184162e-01, 3.2763164184e-01, 1.2635959606e-01, 8.2709591489e-01, 1.6231163152e-02, 2.5498266741e-01, 4.2672646066e-01, 6.1729285423e-01, 2.4776547617e-01, 5.8253655311e-01, 4.1800350860e-01, 7.6307204524e-01, 4.8597874104e-01, 6.5406277933e-01, 2.3386231791e-01, 9.7412906334e-01, 7.2033152167e-01, 8.4753365431e-01, 6.5065584031e-01, 7.1258330055e-02, 4.6992623095e-01, 7.3252655014e-02, 8.3181286038e-01, 7.3510444240e-02, 6.4031080122e-01, 5.0026947606e-01, 8.7563215563e-03, 9.0946087698e-01, 2.5201047339e-01, 9.4617862262e-02, 5.4118066196e-01, 6.8452747694e-01, 4.4076582841e-01, 7.0581408573e-01, 5.3599031385e-01, 3.8595206439e-01, 5.1652244728e-01, 7.6302030271e-02, 2.7681701847e-01, 9.6498381144e-01, 3.8308196809e-01, 4.0174327062e-01, 8.1754130601e-01, 8.9475158941e-01, 1.8430812850e-01, 6.4739789264e-01, 4.2785717213e-01, 3.0103958338e-01, 4.2971122284e-01, 3.9124236420e-01, 8.8211137757e-01, 4.4494535646e-01, 4.7949036674e-01, 9.5008181280e-01, 6.0052809014e-01, 9.4942819737e-01, 5.1899611414e-01, 4.7607984519e-01, 6.2400755259e-01, 6.7322784006e-01, 9.5390287738e-01, 5.1702358461e-01, 3.2760193592e-02, 2.0104526109e-01, 2.7847330088e-01, 8.4000561379e-01, 5.3748329170e-01, 6.7338449963e-01, 3.6643257212e-01, 8.8717185735e-01, 9.4700667057e-01, 8.7129110795e-01, 4.5453488870e-01, 6.2960830203e-01, 8.9263950988e-01, 5.1912163549e-01, 2.5985338960e-02, 4.5126031043e-01, 8.0064710596e-01, 2.7008061424e-01, 4.5951298313e-03, 8.1174139972e-02, 5.0794908332e-01, 8.6138731056e-01, 4.8893623729e-01, 1.4594843166e-01, 3.9855423806e-02, 8.0615856264e-01, 6.2283229626e-01, 9.4191468557e-01, 2.1165962917e-01, 5.6723798705e-01, 9.4179269340e-01, 2.7159664749e-01, 3.9572683690e-02, 7.4252711524e-01, 4.6756632098e-01, 6.5146907229e-01, 3.0550628241e-01, 8.4615382594e-01, 5.2395852576e-01, 9.8288750322e-01, 5.4928684038e-01, 5.2899351041e-01, 4.2406654419e-01, 3.5388208645e-02, 1.6835017140e-01, 8.3388494966e-01, 8.6692915919e-01, 7.7787588648e-01, 6.1496643901e-01, 8.6001323761e-01, 2.6907860691e-01, 9.2058345660e-01, 3.0063694644e-01, 8.4970177643e-01, 7.4220469183e-01, 4.6814196811e-01, 6.3119755748e-01, 2.1704608321e-01, 3.6977255519e-01, 6.2770673059e-01, 3.8153838406e-01, 7.0640451228e-01, 2.3362532885e-01, 9.3892138170e-01, 9.8926566328e-01, 7.4841623113e-01, 1.9433384418e-01, 9.7020186339e-01, 8.1565236412e-01, 5.8136248015e-01, 9.7601693438e-01, 7.4575071486e-01, 7.9301394350e-01, 4.8290800229e-02, 8.5952746361e-01, 2.9363033696e-01, 2.9485523610e-01, 9.8065436639e-01, 5.4724938292e-01, 4.9696525783e-01, 8.6324259025e-01, 9.9514478310e-01, 8.5217204881e-01, 4.1636157994e-01, 7.8883868068e-01, 6.6647843129e-01, 6.2103297065e-01, 9.6591897713e-01, 4.1608404055e-01, 3.5792997656e-01, 5.7865873646e-01, 1.7308225906e-02, 2.8508407044e-01, 5.7919384278e-02, 2.1665067082e-01, 5.5254134535e-01, 1.6600976151e-01, 4.4538206384e-01, 8.5055315106e-01, 7.4848784900e-01, 6.5181802222e-01, 4.2430392443e-01, 2.4979952051e-02, 5.5719710546e-01, 1.8550457877e-01, 1.5394059839e-01, 7.3201974985e-01, 8.3098159963e-01, 8.9287507731e-01, 3.4891339545e-03, 7.2423319547e-01, 1.0423644803e-02, 7.9958210345e-02, 5.9210167000e-02, 1.2785732408e-01, 4.7266055954e-01, 5.0399737914e-01, 5.2911689481e-01, 1.5798594935e-01, 4.5882775810e-01, 4.8328301754e-02, 9.9940132200e-01, 9.9295559157e-01, 2.5500322817e-01, 9.9534561419e-02, 3.6542720284e-01, 9.3795328311e-01, 5.9506827149e-01, 2.8305869067e-02, 2.8801819522e-02, 2.1218307884e-01, 5.0838014839e-01, 6.3373112020e-01, 7.6164683839e-01, 7.1500561727e-01, 6.4875359354e-01, 3.4453447680e-01, 2.1756045514e-01, 2.9452047368e-01, 4.6365881581e-01, 7.6614279988e-03, 1.8074424770e-01, 7.1918734755e-01, 5.4473712677e-01, 2.5192109602e-01, 6.0359624331e-01, 9.6643399050e-01, 1.9656672996e-01, 9.4607517240e-01, 9.7082339177e-01, 4.7573071661e-01, 1.2190569623e-03, 3.5764232644e-01, 7.8926550554e-01, 3.9811764483e-02, 4.0071797941e-01, 5.2530468487e-02, 2.0787480292e-01, 3.7592860004e-01, 5.1512659651e-01, 5.0234783874e-01, 7.6038903646e-01, 4.0680435907e-01, 4.9265918200e-02, 9.6949442664e-01, 3.9864304815e-01, 9.1000363535e-01, 6.4487146087e-01, 4.5179757654e-01, 6.4618629734e-01, 6.4934610741e-01, 8.0180676800e-01, 9.3151386049e-01, 1.1997254094e-01, 1.7447277208e-01, 5.6690026677e-01, 4.8419379151e-01, 7.0656652183e-01, 8.2923488117e-01, 8.5001420505e-01, 2.6894207261e-01, 1.1768958222e-01, 9.7045169215e-01, 2.3016092353e-02, 5.7635614012e-01, 7.1353511399e-01, 5.0637636649e-01, 1.6928016483e-01, 1.6788098872e-01, 5.2327017591e-01, 6.4144061672e-01, 8.8178376347e-01, 6.5380092825e-01, 7.0763762224e-01, 7.6406324682e-01, 7.2840614491e-01, 3.1212498362e-01, 2.9981924050e-01, 9.3906187988e-01, 1.3431920303e-01, 6.1462830598e-01, 4.0519205333e-01, 9.3141967375e-01, 5.8955424262e-01, 7.6287944647e-01, 9.6034892481e-01, 4.8391926212e-02, 9.1105694382e-01, 7.5971224889e-01, 9.3954412936e-01, 9.4720392700e-01, 3.1627328104e-01, 2.6056198204e-01, 2.6090194240e-01, 6.4696076183e-01, 1.0202880870e-01, 2.0391472831e-01, 6.9966200805e-01, 8.5036716877e-01, 1.6055464901e-01, 7.7628110419e-01, 3.0986488617e-01, 4.0768835156e-01, 9.5096276054e-01, 6.6472358540e-01, 8.6512199523e-01, 6.5682561590e-01, 6.5460517821e-01, 6.3150296216e-01, 8.9445729701e-01, 7.0529034251e-01, 4.0898345189e-01, 3.8417362446e-01, 1.0959321419e-01, 8.3581471130e-01, 1.1936510621e-01, 8.8782498504e-01, 4.0639842048e-02, 1.7903180207e-01, 1.9974183183e-01, 3.4422356400e-01, 7.1083774693e-01, 5.5958565922e-01, 7.8072083632e-01, 4.0156994743e-01, 7.0419464703e-01, 3.9316100604e-01, 2.3755285629e-01, 7.2614228918e-01, 1.5064275129e-01, 6.3649139351e-01, 8.3376167005e-01, 1.1255803504e-03, 5.9657507686e-01, 7.1936560069e-01, 6.1615811295e-01, 5.6048059773e-01, 3.3570267130e-01, 1.3770846113e-01, 1.1537727212e-01, 3.9591966789e-01, 9.2172515799e-01, 9.9547179949e-02, 8.9211270500e-01, 3.0157980582e-01, 2.1318682184e-01, 1.3400682607e-01, 4.7031655521e-02, 7.2189505081e-01, 8.2000541415e-01, 7.4334266041e-01, 7.4005140556e-01, 5.6017381247e-01, 2.5139121414e-01, 2.4904491868e-01, 6.7800432818e-01, 6.2106162079e-01, 4.8168950866e-01, 9.4179074282e-01, 9.7640017409e-01, 5.7266447965e-01, 3.7332247448e-01, 1.1637741181e-01, 1.9980466573e-01, 4.9936104903e-01, 5.1334471428e-01, 8.2647407198e-02, 5.0308277706e-01, 9.3772845839e-01, 3.4661741515e-01, 3.5041510592e-01, 1.9168905793e-01, 6.4035994177e-01, 9.3678328452e-01, 2.1516128031e-01, 7.4751742847e-01, 9.6427637291e-01, 8.5947830480e-01, 1.3769192900e-02, 8.9168326574e-01, 4.6178713181e-01, 2.5874899290e-01, 2.4360648495e-01, 8.2389610670e-01, 9.3549036232e-01, 2.7000112624e-02, 5.0970947649e-02, 7.3532985060e-02, 7.3548584453e-01, 1.7452977716e-01, 2.6850687681e-01, 2.9418565424e-01, 9.0751704958e-01, 2.7305693552e-01, 5.9151219536e-01, 8.1621675204e-01, 1.4630147449e-01, 8.8309763445e-01, 9.6267498952e-01, 5.7129490611e-02, 6.1349967642e-01, 2.7639399735e-02, 4.8227519445e-02, 9.7956938533e-01, 2.7417215621e-01, 3.8220879723e-01, 5.5219994473e-01, 7.4651745978e-01, 7.7113498220e-01, 4.7925062198e-01, 1.3039077362e-01, 1.1629328097e-01, 2.7290742524e-01, 4.5745734432e-01, 3.0944318661e-01, 1.3055279669e-01, 3.0377834611e-01, 7.8587606815e-01, 5.5839418959e-01, 6.0791936889e-01, 3.0034968505e-01, 4.3218682974e-01, 5.6020480236e-01, 9.0450839089e-01, 7.3199263119e-01, 7.5826694521e-01, 2.5402358158e-01, 8.2398497737e-01, 4.3033181549e-01, 4.9152380982e-01, 5.1699717671e-02, 6.3653437621e-01, 4.7263302017e-01, 3.4359946286e-01, 6.7195255131e-01, 8.2885956404e-01, 3.0097170362e-01, 7.7092271496e-02, 9.9741122340e-01, 4.1981782119e-01, 3.5865960218e-01, 9.6506818742e-01, 2.7763770527e-01, 3.8079502674e-01, 1.6174961260e-01, 1.6298947747e-01, 9.8188991029e-01, 5.6480275018e-01, 4.8110609153e-01, 1.2909820900e-01, 8.8212645964e-01, 7.7032750842e-01, 5.6283767329e-01, 4.0329426742e-01, 2.8161092217e-01, 2.1375134114e-01, 8.6822487681e-01, 8.7641473922e-01, 1.9431718820e-02, 7.7419777282e-01, 2.1427635130e-01, 8.0104982499e-01, 7.2729077312e-02, 6.1397251986e-01, 1.9394994883e-01, 7.0222699877e-01, 5.6142323173e-01, 9.3952330651e-01, 8.3320033962e-01, 3.6770626585e-01, 8.9718517527e-01, 5.9043210798e-01, 4.4659631806e-01, 9.8237270997e-01, 5.4990172168e-01, 9.8791315504e-01, 2.5239778295e-01, 5.0502591521e-02, 3.3908996419e-01, 6.4058858654e-01, 7.6148452262e-01, 3.2853554489e-01, 1.1366302538e-01, 3.5667818769e-02, 9.9784638558e-01, 8.2801070676e-01, 8.4492360507e-01, 9.3495790348e-01, 1.0973362581e-01, 5.6738469535e-01, 2.8456629903e-01, 8.8876595556e-02, 2.9384126411e-02, 8.9108927226e-01, 4.7892369051e-01, 7.6831902934e-01, 6.9876108348e-01, 5.8473967136e-01, 5.7083840634e-01, 5.1276837068e-01, 9.3970395986e-02, 6.9811688573e-01, 3.2629185007e-01, 7.0817858695e-01, 7.0494153663e-01, 5.6288449595e-01, 7.7220289172e-01, 2.2812493576e-01, 7.9284567411e-01, 1.7675638742e-01, 4.7913584960e-01, 9.9110868556e-01, 9.2172852359e-01, 9.2104532364e-01, 7.0836208674e-01, 8.2024006108e-02, 2.4202361097e-01, 8.6033072779e-01, 9.8840658779e-01, 8.0944273620e-01, 8.9032784392e-01, 6.2093408145e-01, 2.2128873780e-01, 1.1637369464e-01, 5.7798801052e-01, 1.5918368738e-01, 9.8581741039e-01, 1.9695746034e-01, 7.9233540725e-01, 1.2354666278e-01, 1.7882254216e-01, 5.8596839938e-01, 9.2604095177e-01, 4.5386928330e-01, 7.4595948302e-01, 9.4447197355e-01, 6.9477039244e-01, 8.4961600922e-01, 3.1479787748e-01, 1.9162484302e-01, 7.5973772486e-01, 5.5689564694e-01, 4.6332742257e-01, 2.2868518571e-01, 2.5052174781e-01, 1.7768053714e-01, 7.9128767151e-01, 8.9480532875e-01, 7.8816654210e-02, 5.7230106571e-01, 3.5286557119e-01, 3.3194358540e-03, 6.7232128897e-01, 4.0661874532e-01, 7.0609827913e-01, 5.0884372015e-02, 7.4723188697e-01, 6.6913324087e-01, 2.4602814541e-01, 5.8130496119e-01, 1.0380045721e-01, 1.6960554075e-01, 6.3881297469e-01, 1.2329102373e-01, 4.2505040290e-01, 8.8062278763e-01, 4.3617100127e-01, 3.1478155043e-01, 2.9118420403e-01, 7.0441507484e-02, 6.4467641941e-01, 4.5877134735e-01, 5.2015059317e-02, 2.1351056468e-01, 9.3327016873e-01, 5.3724795499e-01, 1.9271823101e-01, 5.3961570449e-01, 6.0633177647e-01, 2.4838681224e-01, 6.2491244748e-02, 4.8743552180e-01, 9.4446486031e-01, 8.0710302583e-01, 8.6020627633e-01, 8.3675249892e-01, 9.7624466672e-01, 8.2207860854e-01, 2.9064255427e-01, 8.1718091072e-01, 6.4680227522e-01, 6.9527162801e-01, 6.7333986453e-01, 4.9878423846e-02, 9.7114892805e-01, 2.7069437020e-02, 7.4362328625e-01, 1.4761950573e-01, 2.9842216327e-01, 4.0007964730e-01, 7.6489152471e-01, 4.2015289577e-01, 7.9605349821e-01, 7.3819872252e-01, 1.9512966038e-01, 2.0319171833e-01, 8.7732807426e-01, 5.5967349948e-01, 6.3493548590e-01, 8.3742201068e-01, 9.8003186057e-01, 7.6664223530e-02, 5.0698431866e-01, 1.2010277897e-01, 6.9917135638e-01, 4.7314707682e-01, 5.7506993948e-01, 8.4001398649e-01, 7.6592496262e-01, 6.6536285775e-01, 9.9562705846e-02, 9.0801501215e-01, 5.8111153458e-01, 9.7115267026e-02, 1.7445178997e-01, 2.9051740714e-01, 9.8898074885e-01, 8.1774689946e-01, 5.3646132041e-01, 1.1582129592e-01, 4.6066221380e-01, 7.2393041999e-01, 7.4253204993e-01, 7.2894941476e-02, 4.4213697840e-01, 2.1063656013e-01, 4.8890414251e-01, 3.9448614476e-01, 6.6223864718e-01, 1.2725905767e-01, 1.7340904237e-01, 1.2575156319e-01, 8.5293793370e-01, 3.1041621920e-01, 7.5332010172e-01, 3.3748871962e-01, 1.4936887922e-01, 8.0806940118e-01, 7.6024045512e-01, 5.3345755805e-01, 5.4294645019e-01, 5.3077385780e-01, 9.6531596449e-01, 2.5960398374e-01, 5.8407004792e-01, 9.8273496053e-01, 1.0026757311e-01, 6.1041595548e-01, 3.1629060854e-01, 7.6508131181e-01, 3.3765909861e-01, 3.8824080188e-01, 7.1677057116e-01, 1.3413382804e-01, 2.3453364642e-01, 6.8674585568e-01, 4.2652211868e-01, 7.1409028714e-01, 1.7052933305e-01, 5.4854261962e-01, 6.8461703859e-01, 3.9148059302e-02, 5.7800359261e-01, 1.0323441150e-01, 6.6536285315e-01, 5.0439148759e-01, 3.3632573690e-01, 4.3795958554e-01, 4.3610291774e-01, 3.3542293411e-01, 1.6750490225e-02, 4.8653101720e-01, 1.4746872956e-01, 7.0094591306e-01, 8.9170073108e-01, 3.4133293972e-01, 7.2313602312e-01, 5.7728055080e-01, 7.3963745681e-01, 4.7778644310e-01, 9.4890356667e-01, 2.6554714751e-01, 5.1063982264e-01, 9.6035927177e-01, 8.0863008601e-01, 7.0917916144e-01, 7.6523943523e-01, 6.5399671324e-01, 9.5835159363e-01, 3.7318830634e-01, 7.0159095322e-01, 8.7898623091e-01, 2.8576624877e-01, 8.7762353716e-02, 6.4052598298e-02, 1.1856207878e-01, 2.3751627923e-01, 5.5051859290e-01, 6.1669834215e-01, 2.8153039688e-01, 7.8802112989e-01, 9.5141651950e-01, 8.8426147380e-01, 6.0202385532e-01, 9.5353977794e-02, 6.0013866032e-01, 3.7298024637e-01, 4.5123924009e-01, 1.2227163763e-01, 9.1833199902e-01, 5.3876418095e-01, 6.7416832083e-02, 7.2227853094e-01, 9.7878494810e-01, 3.9536623632e-01, 8.5798770526e-01, 2.5089664176e-01, 4.3477287394e-01, 9.3375183465e-01, 5.6565967476e-01, 2.8195333187e-01, 9.4353548499e-01, 6.3461768632e-01, 5.4199631583e-01, 4.6766886795e-01, 7.0521849635e-01, 3.2253881027e-03, 2.6288053757e-01, 1.8515530133e-01, 1.2398853675e-01, 9.7221930183e-01, 1.0012473552e-01, 1.3987220984e-01, 3.6890585195e-01, 4.0995188624e-01, 8.9847170785e-02, 7.9721157638e-02, 3.6377107390e-01, 7.6754832848e-02, 3.9446878824e-01, 8.8817934802e-01, 2.2823278232e-01, 5.0923600383e-01, 5.1472890103e-01, 8.9824650575e-01, 3.3469309514e-01, 8.4536576593e-01, 9.9998842241e-01, 8.7176647762e-01, 4.3318554060e-01, 9.8666222951e-01, 8.9084962282e-01, 9.8391689073e-01, 1.1759743191e-01, 6.4178923517e-01, 4.1048635312e-01, 3.1170383107e-01, 6.9827784986e-01, 4.0180644174e-01, 2.0423159160e-01, 2.0900861165e-01, 4.8085932743e-01, 7.4841099234e-01, 2.7526796822e-01, 9.2933409480e-02, 7.5707435470e-01, 8.1946018666e-01, 7.9330817570e-01, 5.1197400476e-01, 9.5862001899e-01, 5.0529113707e-01, 2.7063826427e-01, 7.7697969843e-01, 7.8730464376e-01, 4.6261302366e-01, 2.5997209739e-01, 4.7937617612e-01, 1.0379713786e-01, 5.3162223001e-01, 4.7597256170e-01, 8.8552410692e-01, 2.1281893912e-01, 1.5369804739e-01, 1.1583351900e-01, 5.6581732733e-01, 2.8583610159e-01, 8.4555643665e-01, 7.9661335641e-01, 6.1384908264e-01, 3.4212856757e-01, 7.3744129198e-01, 2.3940774379e-01, 5.2495819195e-01, 6.7769588532e-01, 2.2793021537e-01, 3.2000244866e-01, 4.4340522620e-01, 8.2160281074e-01, 1.3987181148e-01, 6.6204485921e-03, 1.3187730496e-01, 9.8894767042e-01, 7.6407030826e-01, 9.0531672918e-02, 5.7272587242e-01, 4.5538760055e-01, 2.9790061318e-01, 7.2019284423e-01, 8.4563882638e-02, 4.3793114714e-01, 3.9186893834e-01, 9.4625587166e-01, 9.3718360325e-01, 1.5090440250e-01
	};

/* Expected test values from pywavelets
* cA5_db2, cD5_db2, cD4_db2, cD3_db2, cD2_db2, cD1_db2 = pywt.wavedec(signal, "db2", level=5)
*/
static float32_t cD1Expected[ 501 ] =
{
		4.6457865281e-01, -7.6272115464e-02, -2.2441722614e-01, -2.8001015800e-01, -1.4343951290e-01, 2.6106200289e-01, -2.0134754754e-01, -1.9946220500e-02, -7.5553782602e-02, 4.1470297253e-01, 2.3146884530e-01, 1.3025717968e-01, -4.5401082115e-01, 2.9486730390e-01, 5.9665220738e-01, -1.8510982686e-01, -2.4978087864e-01, 8.8937205569e-02, 2.9578553726e-01, -8.4444817539e-02, -3.5343277351e-01, 7.4399393497e-02, 1.5055093394e-01, 6.6043501051e-02, -4.8633527627e-01, -4.4959150771e-01, 5.6935141792e-04, -2.4120748972e-01, 5.0794498628e-01, 5.5282040653e-01, 3.5254729578e-01, 4.2193442826e-02, 3.1902133008e-01, -4.8321536305e-01, -2.1419472876e-01, 7.6781101512e-01, 2.0245100242e-01, 1.9988789860e-02, 3.2270656348e-01, 2.2090920550e-01, 5.8997009549e-01, 1.0955058710e-01, 5.1606211569e-01, -1.3055466170e-01, 4.4785910572e-01, 3.8519099524e-01, 5.8095546683e-02, 3.5338078257e-01, -1.8959072202e-01, 1.2536223221e-01, -2.2454451412e-01, 4.4346192917e-01, -5.2795900262e-01, 3.4917957214e-01, 5.8329633422e-02, -1.4774850746e-01, -4.4045862448e-03, 2.5718919529e-01, 7.8944839716e-02, 4.3939955544e-01, 1.4377941757e-01, 9.0168872262e-02, 1.3129531100e-01, -5.7297514180e-02, 2.2482269439e-01, 1.5928408399e-01, 1.8267379673e-01, -4.6085953462e-01, -2.7517209138e-01, 2.4797706586e-02, -4.4378323972e-01, 6.6950786820e-02, -4.2264887359e-01, 5.2272447485e-01, -3.5558210074e-02, -7.7908400001e-02, 3.4228841754e-01, -5.0259413093e-01, 3.4222926293e-01, 5.9751444264e-02, -3.7079729424e-02, 2.0436099884e-01, -2.7674734412e-01, -2.1211593641e-01, 5.0860914481e-02, -3.5870466011e-01, -2.9269504487e-02, 7.5210669577e-02, -1.8037365312e-01, 3.8313425475e-01, 3.8743029330e-01, -4.7450778212e-01, 6.3995405285e-02, 5.2759771009e-01, -3.8132271401e-01, -3.4658777340e-01, 3.8737700998e-01, 4.1416686514e-01, -4.8300282201e-01, -3.1131015185e-01, -4.1918199470e-04, -2.6766856598e-01, -1.8150395621e-01, -1.3449047942e-01, -4.8433300660e-01, -5.5367327833e-02, 2.2668185800e-01, 2.5754945871e-01, 5.8309013845e-01, 1.6989740074e-01, -6.2690571929e-01, -3.9869278881e-02, 6.8284493934e-02, -1.9564079293e-01, 4.6720908124e-02, 2.3935735838e-01, -3.1843499910e-01, -1.2569075063e-01, 1.1213205207e-01, -4.6484313006e-01, 4.3557051267e-02, 4.7659922827e-02, 3.7970514247e-01, -2.7163815624e-01, -2.3119270167e-01, -8.6302759878e-02, 2.2974995217e-02, 3.1659968093e-01, -3.0902475096e-01, -2.2204664544e-01, -9.9925407476e-02, -3.4243474647e-01, 1.2511123206e-01, -2.4169785489e-01, 2.9604702292e-01, -4.2807881856e-01, 4.3480545566e-01, -1.9950847136e-01, -9.8997744638e-03, 7.9707322234e-02, -4.5199142710e-01, -1.1975366001e-01, -3.8862301111e-01, 5.0212014663e-01, -5.0826352949e-01, -9.5062532237e-02, -3.5963026275e-01, -2.6559397622e-01, -8.4110278893e-02, 1.4799378640e-01, -3.2471814038e-01, 1.4081885823e-01, -1.8747004472e-01, -4.9186823323e-01, -4.0005120891e-01, 1.6541039019e-01, 2.2220233275e-01, -1.2417082330e-01, -2.1055280675e-01, -4.6574374907e-01, 2.2539276029e-01, -6.0178139537e-01, 1.5891653533e-01, 2.2042212256e-01, 3.4658509197e-01, 4.6374853134e-01, -4.0401495553e-01, -4.0197495851e-02, 5.9287480846e-02, 1.7700119845e-01, 1.3438797968e-01, -1.9846912854e-01, -1.2167821651e-01, 3.4162518968e-01, 1.3174107479e-01, -1.3550002770e-01, -2.2811856120e-01, 2.2869680353e-01, 6.2494704415e-02, -4.2766598198e-01, -4.7294953438e-02, 1.5250226114e-01, 4.6422968073e-01, 4.8447003643e-01, -5.7769036278e-02, -1.4494173430e-01, 4.3568266430e-02, -2.7325933594e-01, -5.6553467627e-01, 4.7720261880e-01, -2.7888082196e-01, 4.0242832074e-01, -2.4499288036e-01, -7.8152952860e-02, 2.0870434555e-02, 3.2060620532e-02, -5.4807599571e-02, -7.0909718464e-02, -2.2292389328e-01, 2.9701993548e-01, -2.9594767389e-01, 5.4560996354e-01, 1.5341062437e-01, 5.7332494756e-02, -1.4384965987e-01, -3.8342007865e-01, -1.5142372639e-01, 1.2291556045e-02, -1.1112875544e-01, 8.1059733606e-02, 5.5478107508e-01, 2.3496867244e-01, -1.9645509743e-01, -4.7359931667e-02, 4.5753260346e-01, -2.7528035922e-01, -8.5855081668e-02, 6.2111320428e-02, -1.2970163684e-01, 7.3949968006e-01, 6.7757045788e-03, 1.0731555151e-01, -2.1575793911e-01, -2.8306521258e-02, -7.5502539083e-02, 4.4137509564e-02, -1.4584876700e-01, 6.1307478977e-01, 1.6682348899e-01, 3.2405483848e-01, -7.8331363239e-02, -7.1350626799e-01, -2.8723490859e-02, 3.3069620798e-01, -1.0150954056e-01, 3.9971832223e-01, -2.7392482195e-01, 4.5059060340e-01, 3.5368560247e-01, -2.8815427341e-01, -1.2768094881e-01, -4.6638039569e-02, -1.3545240418e-01, 1.1025341585e-01, 8.5495622985e-02, 5.6724334123e-01, 5.8813519900e-01, -7.0707054475e-02, -1.2329897244e-01, -1.1283241140e-01, -2.5158959113e-01, 4.3484848392e-03, 4.3055020757e-01, 2.0240869106e-03, -5.5643268381e-01, 1.7031523002e-01, 7.5518396161e-02, -8.8304792365e-02, -1.5764770452e-01, -6.0541932922e-01, -6.3528849530e-02, 2.5725319142e-03, 1.7996115941e-01, -1.2818407210e-02, 8.5108290570e-02, -2.4796043537e-01, 1.0269070640e-01, 1.2791920112e-01, -4.1988538167e-02, -1.5693282141e-01, 1.0995186438e-01, -3.5351956481e-01, 4.9356350625e-01, 1.5060830969e-03, -5.0730309833e-03, -4.7388017920e-01, 1.9614139498e-01, -7.3656513004e-01, 5.9679096301e-02, -3.1188711983e-01, 5.5331662789e-01, -1.1998894677e-01, 5.0787639681e-01, -5.1769031785e-02, 5.2658917767e-01, -7.8038210861e-02, -5.6361712820e-01, 5.6082817512e-01, 3.6246914088e-01, -5.1834047984e-01, -1.8104876675e-01, -1.9766236442e-02, 1.7481946628e-01, -1.5430463181e-01, -3.5583654611e-02, 5.7949033450e-02, -1.9474095987e-01, -4.1957778300e-02, -1.6600572622e-01, -1.0396369390e-01, -2.9126888008e-02, -4.5014702055e-01, -9.4972441841e-02, -4.3003592267e-01, 8.0053716514e-02, 2.3611908728e-02, -5.8205818570e-02, 5.7536594760e-01, -3.8924163899e-01, -2.1438949276e-01, -6.4693517894e-02, 4.9112310478e-01, 8.6440464697e-02, 2.7467726638e-01, -1.0773035551e-02, -3.0894334333e-02, 2.1865426180e-01, -6.6645341854e-01, -3.8367802857e-01, -4.4296670444e-01, -3.2393731335e-01, -1.6661407246e-01, 2.3615527863e-01, 2.7511005283e-01, -3.4931052622e-01, -2.9511029502e-01, -1.0585321337e-01, -6.9708769198e-02, 2.9085826041e-01, -9.4327836119e-02, 4.1211250640e-01, -5.9481968609e-02, -5.0113803955e-01, 5.3743872725e-02, -4.6252950279e-01, -1.7397690330e-01, 6.7926178383e-02, 8.3753777043e-03, -4.4736260817e-01, -2.3771482421e-01, 1.1688359237e-01, 3.1839116932e-01, 4.2679833993e-01, -2.2008442865e-01, 4.2054528995e-02, 2.2721477193e-01, -3.2310511554e-01, 2.1172938645e-01, 1.3554477380e-01, -1.2548800958e-01, 3.5189525682e-01, 6.1905198759e-01, 4.3141206263e-01, -2.6364100681e-01, 4.0096375945e-01, -5.3708200431e-02, -1.3737812419e-01, -1.0956025895e-01, 2.8288367289e-01, 5.3992438826e-02, 1.2535054029e-02, 1.5752134725e-01, -5.1343406094e-01, 1.5509723877e-01, 3.1961774951e-01, 3.8794158259e-01, 1.9912385569e-01, -3.2162321724e-01, -1.5721673860e-01, 4.2338366683e-01, -1.8004996397e-01, -3.9555428425e-02, 8.2558663075e-02, 2.6424174831e-01, -2.4586429112e-01, 4.6663654668e-01, -3.4059731203e-01, 2.4135367254e-01, -3.1727782107e-01, 2.8291677997e-01, 1.2326209511e-02, 1.2073927532e-01, -4.6214007337e-01, -1.5507766774e-02, 2.9962710009e-01, 7.0099184427e-01, 4.1901488884e-01, -7.2908568422e-02, 3.0863189517e-01, 1.1623018215e-01, -2.0338454214e-01, 3.9280188024e-01, -1.1229187826e-01, 5.1291694608e-01, 2.2208618953e-01, 2.6382684809e-01, -1.2117266919e-01, 5.6659624151e-02, -6.0350673707e-01, 2.2279584140e-01, -9.1346524582e-02, 3.4466367750e-01, 8.1544770721e-02, -5.9663928803e-02, 3.6405597085e-01, 1.5569547202e-01, 1.1402447989e-01, 3.4082151808e-01, -2.9898174709e-02, 5.1294974294e-01, 2.8721382900e-01, -4.3845087101e-01, 1.7785976262e-01, -2.0114125762e-02, 4.9289129987e-01, -1.6915014093e-01, -5.0679104980e-01, -2.5472022052e-01, -1.1746786882e-01, 4.0409050667e-01, -2.5830377249e-01, -1.7236717880e-01, -3.3753015702e-01, 4.0876566971e-01, 3.3628027519e-01, 2.1504596309e-01, -1.2933682317e-01, 6.1120654821e-02, -3.5258324348e-01, -3.2639150062e-01, 4.0487446256e-01, 1.3420772538e-01, 1.6499107596e-01, 4.6271484865e-01, -2.1897729688e-01, 5.2584719362e-02, 6.0676512289e-02, 3.7582199826e-01, -4.5293172430e-02, -9.1149759895e-02, -6.0332311428e-02, -1.0205780249e-01, 2.2577724195e-01, 5.6783678827e-02, 1.3371232767e-01, -4.5945136935e-01, -5.2784874284e-02, -4.9064778341e-01, 1.9646359096e-01, 4.6648652156e-02, -3.9650430303e-01, -2.4357688123e-01, 3.7798590065e-01, -4.6745961408e-01, 2.1128782341e-02, -1.5299246909e-01, -3.4285466700e-01, 3.5663106922e-02, 7.1316863348e-01, -2.0941924213e-01, 1.9874980475e-01, -1.8219025971e-01, -2.1816085858e-01, 5.3439796955e-01, 1.1293406123e-02, 4.0848017961e-01, 3.2943867830e-02, 1.8649466781e-01, 1.8520094596e-01, 4.3890535398e-01, 1.8493051555e-01, -2.5155860539e-01, 4.0629212835e-02, -1.5517294902e-01, 3.5828440289e-01, -4.4644965996e-01, 1.2063333644e-01, -3.1856442945e-01, 1.0852919219e-02, 1.4366584894e-01, -1.5591624864e-02, 2.3273813686e-01, 1.2953223381e-01, 4.6248838796e-01, -8.9669683373e-02, 2.8941381902e-01, 1.8529647811e-01, 6.0280302203e-02, 3.4513266521e-01, -3.7259595890e-02, -1.8371793962e-01, -1.2711091302e-01, -1.2773047101e-01, -3.8689220946e-01, 3.5670109437e-01, 1.3998911454e-01, -2.7481623420e-01, -3.4074342201e-01, -2.3830468944e-01, 4.4827911043e-01, -4.8149570930e-01
};

static float32_t cD2Expected[ 252 ] =
{
		2.6479155426e-01, 1.1543581325e-01, 4.1851097995e-01, 1.7269980466e-01, -6.8264772620e-02, -2.6260777623e-02, 2.8640317285e-01, -1.3629309735e-01, -1.5628523579e-01, -2.8572895764e-01, -5.3202836986e-01, 5.2749248597e-02, -9.8542178635e-02, 3.9166707459e-01, 2.9787829636e-01, -3.5143677018e-02, -4.4000398237e-02, 4.3606151854e-01, 1.9993500883e-01, 6.7835887205e-01, -3.2147357762e-01, 3.1602305005e-01, 4.6510471268e-02, -3.4098399389e-02, -1.0851318478e-01, 4.4509771160e-01, 1.7763294625e-01, 2.4908729713e-01, 7.7007428139e-02, 6.2136742448e-01, -5.9167472056e-01, 1.0167027080e-01, 1.7754056602e-01, 1.1456976118e-02, -6.4594211883e-03, -5.5832005396e-02, 4.5711183671e-01, 1.0969513768e-01, -4.0676777770e-01, -6.1006223674e-02, -2.6803605931e-01, 3.6339476325e-01, 2.8189848984e-01, 2.4860076612e-01, -3.1826454438e-01, 4.6617406184e-01, 2.6387388679e-01, -3.4161236745e-01, 1.7194740700e-03, -1.0772839096e-01, -3.8455949472e-01, -1.0215611543e-01, -1.5235153905e-01, 4.6030376887e-01, -1.3238066774e-01, -6.0575112262e-02, -4.7158080524e-01, 1.7976315222e-01, -5.2844075776e-01, -2.9025400551e-01, 8.7226292652e-03, -1.5404956496e-02, 5.5492641031e-02, -2.9117648331e-01, 3.4753474842e-01, 2.0250919898e-01, -2.0433241642e-02, -5.9441958085e-02, -1.4008219909e-01, -6.5400672951e-01, -3.6988865116e-01, 3.3205510686e-01, -1.2777366100e-01, -2.3024339668e-02, 2.7568156069e-01, -6.0915893834e-01, 2.3746935578e-01, -1.0368002714e-01, 1.6004393025e-01, 2.1572194131e-02, 1.1380488197e-01, 1.8006391722e-03, 4.2464530665e-01, -2.8478746931e-01, -3.5315515641e-01, -1.5587470520e-01, 3.3926682806e-01, -7.5916722464e-02, 1.1121536044e-01, 4.5912142884e-01, 4.1459841530e-03, 6.3053864632e-01, -1.3342624291e-02, 3.9681732015e-02, -4.3413378445e-01, 4.4191062090e-02, 5.9251193875e-01, -1.4230071344e-01, 3.1028455117e-01, 1.0598601100e-01, 1.3783720255e-01, -3.4844342855e-01, -6.0806132516e-01, -2.5000246924e-02, -3.3634702171e-02, -4.0500613985e-01, 1.8812105813e-01, 4.2747665487e-01, -2.2160727721e-01, 4.7722582804e-01, -2.7689073387e-01, -2.5164698506e-01, 2.7757230260e-01, 1.9389188869e-01, -9.0214827586e-02, 5.7218681934e-02, -3.0848375471e-01, -1.0009386125e-02, -3.2028308204e-01, 3.9951946832e-02, 1.0349371583e-01, -1.9584681631e-01, 3.9498320717e-02, 1.5453680297e-01, -3.7672611748e-01, 1.5866968532e-01, -1.0982863249e-01, 3.1208840870e-01, 2.6615540753e-01, -5.5841177663e-01, 3.1795731481e-01, -5.8621121862e-01, 4.1072931864e-01, 1.9730733427e-02, 5.7073284671e-01, -3.8344605899e-01, -3.5648094490e-02, -4.6960932266e-01, -9.9779212768e-02, 1.5266339152e-01, 4.2409734116e-01, -2.9954545436e-01, -2.6936108227e-02, 2.4557873426e-02, 9.9769221994e-02, 3.5420376682e-01, 2.3980467077e-01, -4.4428811042e-01, -3.7062142471e-01, 1.9196549566e-01, 2.4370397460e-01, 9.0188792621e-02, 1.5528438075e-02, 5.1108028748e-01, -4.4430401038e-02, -1.0795955008e-01, 5.1486940388e-01, 4.1339575043e-01, -4.7163492221e-01, -1.2812857959e-01, -1.4869777048e-01, 3.7906216218e-01, -8.7713770284e-02, 5.3137156694e-01, 1.8900554785e-01, -6.8779658239e-01, 3.7003678827e-01, -5.6216299135e-01, 1.8449935695e-01, -8.6209671774e-02, 1.8305234121e-02, 3.2754589487e-02, 9.4280646316e-02, -6.1884739626e-01, 3.3078595283e-01, -4.1693519154e-01, 2.7706568973e-01, -1.9082500960e-02, 1.8386388136e-01, -4.9418800482e-01, -4.1439196784e-02, 4.7883015504e-01, -4.3992293618e-01, -2.6451098677e-01, 9.1131626278e-02, -3.0377049662e-01, 3.1198664000e-02, 2.6986457853e-01, 2.5278029594e-01, -1.4391640844e-01, 2.4342222594e-01, 7.8644268270e-02, 2.4627295578e-01, 2.9714127024e-02, -8.4028504823e-02, 4.0788958562e-01, -3.2232814881e-02, -7.3826511097e-02, -6.5436155945e-02, -8.7967018089e-02, -2.2501176234e-01, 7.3693136480e-01, 3.4078380939e-01, -1.9979202987e-01, -3.1663324124e-03, 2.5450653407e-01, 6.0140783234e-02, 1.0767696616e-01, 3.5088780435e-01, 1.2503792615e-01, -2.2797429211e-01, 1.0205536405e-01, -7.0139910415e-02, 1.9299287625e-01, -4.0562314953e-02, 1.5620103075e-01, 4.6032149826e-02, -3.2011254704e-01, 3.0315420442e-02, -2.4083873989e-01, -2.3660261299e-01, 2.3055190307e-01, 4.4331086602e-01, -1.0937958843e-01, 4.3713242182e-01, 3.1871739286e-01, -2.5030263328e-01, 1.8663179429e-01, 2.3286175564e-01, -8.2898570335e-02, 9.2114629167e-02, -1.1444802132e-01, -5.0119317855e-03, -2.9455450654e-01, -3.5571705119e-01, -1.8488609402e-01, 2.7116697633e-01, 1.0128273775e-01, -6.9622016648e-02, 3.4736616131e-01, 3.9754339201e-01, -3.4715231589e-01, 1.6316620745e-01, -2.0261233414e-01, -2.2752276624e-02, 2.9108870327e-01, 6.0126021079e-01, 5.1550984198e-01, -6.5490898025e-02, -4.9457174912e-01, -1.3702688043e-01, 6.2618622011e-01
};

static float32_t cD3Expected[ 127 ] =
{
		1.2484641024e-01, -9.8567670861e-02, 3.1203584566e-01, 2.8760537551e-01, -3.2435004550e-01, -2.8551000935e-01, 2.1049317307e-01, -2.8329475628e-01, 3.6812215430e-02, 8.1899302159e-02, 1.1426280082e-01, 3.3770030563e-02, -2.9527172884e-01, -2.7840021901e-01, -2.0596485366e-01, -6.2076054869e-02, -1.8934815852e-01, 4.3828284301e-01, -1.1123763321e-01, -2.3805822069e-01, 4.0514151202e-01, 1.1483868029e-01, -1.5047734962e-01, 2.3996502080e-01, -4.3040270188e-03, -6.5133879949e-04, -6.1150628174e-02, 5.4233410871e-02, 3.1113189487e-02, 2.8169879523e-03, 3.6675240098e-01, -1.7086712960e-01, 3.6603252584e-01, -1.2214187478e-01, 1.4230226291e-01, 3.1952428792e-02, 2.5621314318e-01, 1.0818328836e-01, -3.0798463797e-01, 2.6465558256e-01, -2.1543717655e-01, 2.9881507721e-01, -2.6488051437e-01, 1.0596694300e-01, -5.6851965320e-01, 3.6917885931e-01, 5.6567881692e-01, -1.3742845252e-01, 2.1041259695e-01, 4.5229366656e-01, -4.2272936498e-01, 5.1360169575e-01, -5.8750193580e-01, -3.1334312608e-02, -1.9118626706e-01, -1.5390158918e-01, -4.5866030066e-01, -7.4540731594e-02, 1.0433038438e-02, -3.9602004201e-01, -2.5148145558e-01, 4.1098767096e-01, -2.2749485256e-01, 3.2615050766e-01, 1.4884571052e-01, 1.6813199336e-01, 2.7334435899e-01, 1.3734738088e-01, -2.7880223948e-01, -7.3028163887e-02, -1.4164810296e-01, -2.6418479638e-01, 5.9509176073e-01, -6.8826532092e-02, -4.0606102044e-01, -1.8069066708e-01, -1.2437055531e-01, -2.0889998311e-01, -3.1283758702e-01, 8.8930535839e-03, -9.6949230324e-02, 4.7069261153e-02, -2.6827460198e-01, 3.4924030954e-01, -3.3630101680e-01, -2.7561256681e-01, -4.8752513753e-01, -2.2889019519e-01, -2.0582481699e-01, 1.7731883677e-02, 4.6648936761e-02, 1.4739250465e-01, 3.4095547575e-01, 3.8062160710e-01, -1.5040552682e-01, -5.0391257777e-01, 1.8920853993e-01, -3.4302490832e-01, -3.7614384914e-01, -5.0726293412e-01, 2.3760788553e-01, 1.3522213732e-01, 8.4447139545e-02, -5.8290769615e-02, 6.9615673785e-02, -2.8558374935e-02, 1.8161310696e-01, 1.8848374490e-01, 1.1895993516e-01, 1.9591472996e-02, 5.0991451293e-01, -9.4143790403e-02, -1.8098363606e-01, 2.6072856475e-01, 3.4182587977e-01, 9.0722421798e-02, -1.4226013115e-01, 1.6690051448e-01, -1.1992167674e-01, -3.4029759808e-01, 1.0181336938e-01, 2.0866944820e-01, 4.1994792315e-01, 9.0256789422e-02, 1.7175255613e-01, 2.7876939210e-01, -2.1041434576e-01};

static float32_t cD4Expected[ 65 ] =
{
		8.3967804229e-02, -2.5731911041e-01, 1.2376961198e-01, -2.6577050372e-01, 2.6777822350e-01, -2.2888283293e-01, -1.0228531998e-01, 4.7323699585e-01, 1.2253093737e-01, -4.4497563753e-01, -2.5939828920e-01, 1.0668899791e-01, -1.1000191009e-01, -4.5798646312e-01, -1.9478052774e-01, 8.5827953729e-02, 5.7242750434e-01, 6.2412613602e-01, -1.4184103737e-01, -5.7183500922e-02, -3.2468985765e-01, -1.6795347727e-01, 1.2496653818e-01, 2.8573781523e-01, 3.6252393395e-01, 2.0705318734e-02, 7.6687894784e-02, 2.4401743023e-01, -3.0897869915e-01, -3.2004228016e-01, -5.9518797580e-01, 5.9433228962e-02, 4.5120949379e-02, -3.1056832714e-01, 2.8769545655e-01, 4.8802388806e-01, -3.5295367846e-02, 1.9472112918e-01, 4.1914689401e-01, 1.2462214936e-01, 1.2601810632e-01, 5.6790331126e-01, -3.4827710589e-02, -1.7157015895e-01, 3.5404303620e-01, 5.8539627464e-01, 4.5469222237e-02, -7.1509739436e-02, 5.2846270495e-01, -3.4884471106e-01, 1.4322022058e-01, 1.7461511238e-01, 2.1754730050e-01, -4.2269490797e-02, -4.0543394152e-01, 8.4169141300e-01, 3.4678150856e-01, 4.0971353142e-01, -5.3545871501e-01, 1.0018472936e+00, 1.5086264865e-01, -4.3861281244e-01, -2.5202784347e-01, 3.9166679893e-02, 1.2586318419e-01};

static float32_t cD5Expected[ 34 ] =
{
		8.7818500773e-02, -4.6111689306e-01, 4.2487276559e-01, -8.8830102055e-02, -5.2309412976e-01, -2.0526630797e-01, -1.2231687347e-01, 2.4590008165e-01, -3.9459085583e-02, 1.4822714336e-02, 8.6880978658e-02, 5.4779882744e-01, -3.2810373815e-01, 1.5957456676e-01, 1.9254088321e-01, 1.5507540073e-01, -1.7303343806e-01, 4.9511112194e-02, 6.3821122340e-02, -2.0755007037e-01, -7.6195398112e-02, 7.8449173528e-02, 3.6657744960e-01, 1.1364925517e-01, -3.6433286275e-01, 1.0324390035e-01, -4.5341954092e-01, -4.4287399963e-01, -6.8136160016e-02, -3.1947677962e-02, 1.6729985567e-01, -3.5312498974e-03, 4.1882348780e-02, -1.4466645640e-01};

static float32_t cA5Expected[ 34 ] =
{
		2.6823057473e+00, 2.4808766744e+00, 2.6364602870e+00, 2.5239371451e+00, 2.5883033226e+00, 3.0412557662e+00, 2.6394941164e+00, 2.6678699449e+00, 2.6888134584e+00, 3.1476198569e+00, 2.8562391552e+00, 3.5194654550e+00, 3.0117263230e+00, 2.3297029002e+00, 2.6247960146e+00, 3.1112399996e+00, 3.3103501110e+00, 2.6476531133e+00, 2.8296394787e+00, 2.6149724753e+00, 2.7560868819e+00, 2.9788498382e+00, 3.0261117629e+00, 3.2384278101e+00, 2.4614034008e+00, 3.0630760011e+00, 2.9239775501e+00, 2.7150626937e+00, 2.8855219874e+00, 2.9984453485e+00, 2.6290592498e+00, 3.0512303442e+00, 2.5745344240e+00, 2.6920782175e+00
};


test_dwt_status dwt_check_output_f32(
	arm_dwt_out_f32* pExpectedOutput,
	arm_dwt_out_f32* pOutput,
	float64_t epsilon )
{
	test_dwt_status eres = TEST_DWT_ERROR;

	if ( 		( pExpectedOutput == NULL )
			|| 	( pOutput == NULL )
			|| 	( pOutput->decLevel != pExpectedOutput->decLevel ) )
	{
		eres = TEST_DWT_ERROR;
	}
	else
	{
		for ( uint32_t i = 0 ; i < pExpectedOutput->decLevel + 1 ; i++ )
		{
			if ( pExpectedOutput->coeffs[ i ].size == pOutput->coeffs[ i ].size )
			{
				eres = TEST_DWT_SUCCESS ;
				for ( uint32_t j = 0 ; j < pExpectedOutput->coeffs[ i ].size ; j++ )
				{
					if ( relative_error_f32(  	pOutput->coeffs[ i ].pCoeffs[ j ],
												pExpectedOutput->coeffs[ i ].pCoeffs[ j ],
												epsilon
										 ) == TEST_DWT_ERROR )
					{
						eres = TEST_DWT_ERROR;
						break ;
					}
				}
			}
			else
			{
				eres = TEST_DWT_ERROR;
				break ;
			}

			if ( eres == TEST_DWT_ERROR )
			{
				break ;
			}
		}
	}
	return eres ;
}


test_dwt_status relative_error_f32(
	float32_t val,
	float32_t valExpected,
	float64_t epsilon )
{
	test_dwt_status res = TEST_DWT_ERROR;

	if ( valExpected == (float32_t) 0.0 )
	{
		if ( 		( (float64_t) val < epsilon )
				&&	( (float64_t) val > -epsilon ) )
		{
			res = TEST_DWT_SUCCESS; /* IT DID NOT FAIL ! */
		}
	}
	else
	{
		volatile float64_t tmpDiff = ( ((float64_t) val) - ((float64_t) valExpected) ) / ((float64_t) valExpected);
		if ( 		( tmpDiff < epsilon )
				&&	( tmpDiff > -epsilon ) )
		{
			res = TEST_DWT_SUCCESS; /* IT DID NOT FAIL ! */
		}
		else
		{
			res = TEST_DWT_ERROR;
		}
	}

	return res;
}


test_dwt_status dwt_test_f32(
	float64_t epsilon )
{
	test_dwt_status eres = TEST_DWT_ERROR ;

	/* Test Init */
	uint32_t size = 1000;
	uint32_t internalBufferSize = 1100;
	float32_t internalBuffer[ internalBufferSize ] ;

	arm_dwt_instance_f32 pDWTInstance;
	arm_dwt_out_f32 dwtOut;

	/* Fill expected output */
	arm_dwt_out_f32 dwtExpectedOut =
	{
			.decLevel = 5,
			.coeffs =
			{
					{ cD1Expected, 501 },
					{ cD2Expected, 252 },
					{ cD3Expected, 127 },
					{ cD4Expected, 65 },
					{ cD5Expected, 34 },
					{ cA5Expected, 34 },
			}
	};

	/* Test it */
	if ( arm_dwt_init_f32(
			4,
			daub2HighFilter,
			daub2LowFilter,
			ARM_DWT_EM_SYMMETRIC,
			5,
			internalBuffer,
			internalBufferSize,
			&pDWTInstance ) != DWT_STATUS_SUCCESS )
	{
		; /* It failed */
	}
	else if ( arm_dwt_f32( &pDWTInstance, signal, size, &dwtOut ) != DWT_STATUS_SUCCESS )
	{
		; /* It failed */
	}
	else if ( dwt_check_output_f32 ( &dwtExpectedOut, &dwtOut, epsilon ) != TEST_DWT_SUCCESS )
	{
		; /* It failed */
	}
	else
	{
		eres = TEST_DWT_SUCCESS; /* IT DID NOT FAIL ! */
	}

	return eres;
}
